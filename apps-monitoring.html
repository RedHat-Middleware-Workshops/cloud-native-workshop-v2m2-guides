<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Lab3 - Application Monitoring</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article data-line-1">
<div id="header">
</div>
<div id="content">
<div class="sect1 data-line-1">
<h2 id="_lab3_application_monitoring">Lab3 - Application Monitoring</h2>
<div class="sectionbody">
<div class="paragraph data-line-3">
<p>In the previous labs, you learned how to debug cloud-native apps to fix errors quickly using CodeReady Workspaces with Quarkus
framework, and you got a glimpse into the power of Quarkus for developer joy.</p>
</div>
<div class="paragraph data-line-6">
<p>You will now begin observing applications in term of a distributed transaction, performance and latency because as cloud-native
applications are developed quickly, a distributed architecture in production gets ultimately complex in two areas: networking and
observability. Later on we’ll explore how you can better manage and monitor the application using service mesh.</p>
</div>
<div class="paragraph data-line-10">
<p>In this lab, you will monitor coolstore applications using <a href="https://www.jaegertracing.io/" target="_blank" rel="noopener">Jaeger</a> and <a href="https://prometheus.io/" target="_blank" rel="noopener">Prometheus</a>.</p>
</div>
<div class="imageblock data-line-12">
<div class="content">
<img src="quarkus-jaeger-prometheus.png" alt="logo" width="700">
</div>
</div>
<div class="paragraph data-line-14">
<p><strong>Jaeger</strong> is an open source distributed tracing tool for monitoring and troubleshooting microservices-based distributed systems,
including:</p>
</div>
<div class="ulist data-line-17">
<ul>
<li class="data-line-17">
<p>Distributed context propagation</p>
</li>
<li class="data-line-18">
<p>Distributed transaction monitoring</p>
</li>
<li class="data-line-19">
<p>Root cause analysis</p>
</li>
<li class="data-line-20">
<p>Service dependency analysis</p>
</li>
<li class="data-line-21">
<p>Performance and latency optimization</p>
</li>
</ul>
</div>
<div class="paragraph data-line-23">
<p><strong>Prometheus</strong> is an open source systems monitoring and alerting tool that fits in recording any numeric time series, including:</p>
</div>
<div class="ulist data-line-25">
<ul>
<li class="data-line-25">
<p>Multi-dimensional time series data by metric name and key/value pairs</p>
</li>
<li class="data-line-26">
<p>No reliance on distributed storage</p>
</li>
<li class="data-line-27">
<p>Time series collection over HTTP</p>
</li>
<li class="data-line-28">
<p>Pushing time series is supported via an intermediary gateway</p>
</li>
<li class="data-line-29">
<p>Service discovery or static configuration</p>
</li>
</ul>
</div>
<div class="sect3 data-line-31">
<h4 id="_1_create_openshift_project">1. Create OpenShift Project</h4>
<div class="paragraph data-line-33">
<p>In this step, we will deploy our new monitoring tools for our CoolStore application, so create a separate project to house it and
keep it separate from our monolith and our other microservices we already created previously.</p>
</div>
<div class="paragraph data-line-36">
<p>Back in the {{ CONSOLE_URL }}/topology/ns/{{ USER_ID }}-coolstore-dev[Topology View, window=<em>blank], click on the Project drop-down and select _Create Project</em>.</p>
</div>
<div class="imageblock data-line-38">
<div class="content">
<img src="create_project.png" alt="create_dialog" width="700">
</div>
</div>
<div class="paragraph data-line-40">
<p>Fill in the fields, and click <strong>Create</strong>:</p>
</div>
<div class="ulist data-line-42">
<ul>
<li class="data-line-42">
<p>Name: <strong>{{USER_ID}}-monitoring</strong></p>
</li>
<li class="data-line-43">
<p>Display Name: <strong>{{USER_ID}} CoolStore App Monitoring Tools</strong></p>
</li>
<li class="data-line-44">
<p>Description: <em>leave this field empty</em></p>
</li>
</ul>
</div>
<div class="imageblock data-line-46">
<div class="content">
<img src="create_monitoring_dialog.png" alt="create_dialog" width="700">
</div>
</div>
</div>
<div class="sect3 data-line-48">
<h4 id="_2_deploy_jaeger_to_openshift">2. Deploy Jaeger to OpenShift</h4>
<div class="paragraph data-line-50">
<p>In the new project, click <code>+Add</code>, select <em>From Catalog</em>:</p>
</div>
<div class="imageblock data-line-52">
<div class="content">
<img src="add_catalog.png" alt="create_dialog" width="700">
</div>
</div>
<div class="paragraph data-line-54">
<p>Type in <code>jaeger</code> in the search box, and choose <strong>Jaeger (all-in-one)</strong>. We will use this template for our lab, but in production you&#8217;d probably want to use the other option which uses the <a href="https://operatorhub.io/operator/jaeger" target="_blank" rel="noopener">Jaeger Operator for OpenShift</a>.</p>
</div>
<div class="imageblock data-line-56">
<div class="content">
<img src="add_catalog_jaeger.png" alt="create_dialog" width="700">
</div>
</div>
<div class="paragraph data-line-58">
<p>Click <strong>Instantiate Template</strong>, leave the values unchanged, and click <strong>Create</strong>.</p>
</div>
<div class="paragraph data-line-60">
<p>In the {{ CONSOLE_URL }}/topology/ns/{{ USER_ID }}-monitoring[Topology View, window=_blank] you can see Jaeger deploying:</p>
</div>
<div class="imageblock data-line-62">
<div class="content">
<img src="jaeger_top.png" alt="create_dialog" width="700">
</div>
</div>
</div>
<div class="sect3 data-line-64">
<h4 id="_4_observe_jaeger_ui">4. Observe Jaeger UI</h4>
<div class="paragraph data-line-66">
<p>Open the <a href="http://jaeger-query-{{USER_ID}}-monitoring.{{" class="bare">http://jaeger-query-{{USER_ID}}-monitoring.{{</a> ROUTE_SUBDOMAIN}}[Jaeger UI, window=_blank].</p>
</div>
<div class="paragraph data-line-68">
<p>This is the UI for Jaeger, but currently we have no apps being monitored so it’s
rather useless. Don’t worry! We will utilize tracing data in the next step.</p>
</div>
<div class="imageblock data-line-71">
<div class="content">
<img src="jaeger-ui.png" alt="jaeger_ui" width="700">
</div>
</div>
</div>
<div class="sect3 data-line-73">
<h4 id="_5_utilizing_opentracing_with_inventoryquarkus">5. Utilizing Opentracing with Inventory(Quarkus)</h4>
<div class="paragraph data-line-75">
<p>We have a catalog service written with Spring Boot that calls the inventory service written with Quarkus as part of our
cloud-native application. These applications are easy to trace using Jaeger.</p>
</div>
<div class="paragraph data-line-78">
<p>In this step, we will add the Quarkus extensions to the Inventory application for using <strong>smallrye-opentracing</strong>. Run the following
commands to add the tracing extension via CodeReady Workspaces Terminal:</p>
</div>
<div class="listingblock copypaste data-line-82">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">mvn quarkus:add-extension -Dextensions="opentracing" -f $CHE_PROJECTS_ROOT/cloud-native-workshop-v2m2-labs/inventory</code></pre>
</div>
</div>
<div class="paragraph data-line-86">
<p>You should see:</p>
</div>
<div class="listingblock data-line-89">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">✅ Adding extension io.quarkus:quarkus-smallrye-opentracing</code></pre>
</div>
</div>
<div class="paragraph data-line-93">
<p>and <code>BUILD SUCCESS</code>. This ensures that the extension&#8217;s dependencies are added to <code>pom.xml</code> for the inventory microservice.</p>
</div>
<div class="admonitionblock note data-line-96">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="admonitionblock note data-line-97">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There are many <a href="https://quarkus.io/extensions/" target="_blank" rel="noopener">more extensions</a> for Quarkus for popular frameworks like
<a href="https://vertx.io/" target="_blank" rel="noopener">Vert.x</a>, <a href="http://camel.apache.org/" target="_blank" rel="noopener">Apache Camel</a>,
<a href="http://infinispan.org/" target="_blank" rel="noopener">Infinispan</a>, Spring DI compatibility (e.g. <code>@Autowired</code>), and more.
</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-102">
<h4 id="_6_create_the_configuration">6. Create the configuration</h4>
<div class="paragraph data-line-104">
<p>Before getting started with this step, confirm the <strong>jaeger-collector</strong> service by visiting the {{ CONSOLE_URL }}/topology/ns/{{ USER_ID }}-monitoring[Topology View, window=<em>blank], and click on the _jaeger</em> deployment and select the <em>Resources</em> tab to view the services exposed by Jaeger:</p>
</div>
<div class="imageblock data-line-106">
<div class="content">
<img src="jaeger-services.png" alt="create_dialog" width="700">
</div>
</div>
<div class="paragraph data-line-108">
<p>We will configure our app to use the <code>jaeger-collector-http</code> service on port <code>14268</code> to report traces.</p>
</div>
<div class="paragraph data-line-110">
<p>In the <code>inventory</code> project under <code>cloud-native-workshop-v2m2-labs</code> workspace, open <code>src/main/resources/application.properties</code> file and add the following configuration via CodeReady Workspaces Terminal:</p>
</div>
<div class="listingblock copypaste data-line-113">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties"># Jaeger configuration
quarkus.jaeger.service-name=inventory
quarkus.jaeger.sampler-type=const
quarkus.jaeger.sampler-param=1
quarkus.jaeger.endpoint=http://jaeger-collector.{{ USER_ID }}-monitoring:14268/api/traces</code></pre>
</div>
</div>
<div class="paragraph data-line-121">
<p>You can also specify the configuration using environment variables or JVM properties. See
<a href="https://www.jaegertracing.io/docs/1.12/client-features/" target="_blank" rel="noopener">Jaeger Features</a>.</p>
</div>
<div class="admonitionblock note data-line-125">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph data-line-126">
<p>If the <code>quarkus.jaeger.service-name</code> property (or <code>JAEGER_SERVICE_NAME</code> environment variable) is not provided then a ``no-op''
tracer will be configured, resulting in no tracing data being reported to the backend.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note data-line-131">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="admonitionblock note data-line-132">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
there is no tracing specific code included in the application. By default, RESTful requests sent to the app will be traced
without <strong>any</strong> code changes being required thanks to MicroProfile Tracing. It is also possible to enhance the tracing information and manually trace other methods and classes. For more information on this,
please see the
<a href="https://github.com/eclipse/microprofile-opentracing/blob/master/spec/src/main/asciidoc/microprofile-opentracing.asciidoc" target="_blank" rel="noopener">MicroProfile OpenTracing specification</a>.
</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 data-line-138">
<h4 id="_7_re_deploy_to_openshift">7. Re-Deploy to OpenShift</h4>
<div class="paragraph data-line-140">
<p>Repackage and re-deploy the inventory application via the Terminal:</p>
</div>
<div class="listingblock copypaste data-line-143">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">mvn package -DskipTests -f $CHE_PROJECTS_ROOT/cloud-native-workshop-v2m2-labs/inventory &amp;&amp; \
oc start-build -n {{USER_ID}}-inventory inventory-quarkus --from-file $CHE_PROJECTS_ROOT/cloud-native-workshop-v2m2-labs/inventory/target/*-runner.jar --follow</code></pre>
</div>
</div>
<div class="paragraph data-line-147">
<p>In the console and on the {{ CONSOLE_URL }}/topology/ns/{{ USER_ID }}-inventory[Inventory Topology View, window=_blank], wait for the re-build and re-deployment to complete.</p>
</div>
</div>
<div class="sect3 data-line-149">
<h4 id="_8_observing_jaeger_tracing">8. Observing Jaeger Tracing</h4>
<div class="paragraph data-line-151">
<p>In order to trace networking and data transaction, we will call the Inventory service using <strong>curl</strong> commands via CodeReady Workspaces Terminal.</p>
</div>
<div class="paragraph data-line-153">
<p>To generate traces, call the inventory 10 times:</p>
</div>
<div class="listingblock copypaste data-line-156">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">URL="http://$(oc get route -n {{ USER_ID }}-inventory inventory-quarkus -o jsonpath={% raw %}"{.spec.host}"{% endraw %})"

for i in $(seq 1 10) ; do
  curl -s $URL/services/inventory/165613
  sleep .2
done</code></pre>
</div>
</div>
<div class="paragraph data-line-165">
<p>Now, reload the <a href="http://jaeger-query-{{USER_ID}}-monitoring.{{" class="bare">http://jaeger-query-{{USER_ID}}-monitoring.{{</a> ROUTE_SUBDOMAIN}}[Jaeger UI, window=_blank] and you will find that a new <code>inventory</code> service appears alongside the service for Jaeger itself:</p>
</div>
<div class="imageblock data-line-167">
<div class="content">
<img src="jaeger-2-services.png" alt="jaeger_ui" width="700">
</div>
</div>
<div class="paragraph data-line-169">
<p>Select the <code>inventory</code> service and then click on <strong>Find Traces</strong> and observe the first trace in the graph:</p>
</div>
<div class="imageblock data-line-171">
<div class="content">
<img src="jaeger-reload.png" alt="jaeger_ui" width="700">
</div>
</div>
<div class="paragraph data-line-173">
<p>If you click on the single <strong>Span</strong> and you will see a logical unit of work in Jaeger that has an operation name, the start time of the
operation, and the duration. Spans may be nested and ordered to model causal relationships:</p>
</div>
<div class="imageblock data-line-176">
<div class="content">
<img src="jaeger-span.png" alt="jaeger_ui" width="700">
</div>
</div>
<div class="paragraph data-line-178">
<p>As applications get more complex and many microservices are calling each other, these spans and traces will become more complex but also reveal issues with the app.</p>
</div>
</div>
<div class="sect3 data-line-180">
<h4 id="_9_deploy_prometheus_and_grafana_to_openshift">9. Deploy Prometheus and Grafana to OpenShift</h4>
<div class="paragraph data-line-182">
<p>OpenShift Container Platform ships with a pre-configured and self-updating monitoring stack that is based on the
<a href="https://prometheus.io">Prometheus</a> open source project and its wider eco-system. It provides monitoring of
cluster components and ships with a set of alerts to immediately notify the cluster administrator about any occurring problems and
a set of <a href="https://grafana.com/">Grafana</a> dashboards.</p>
</div>
<div class="imageblock data-line-187">
<div class="content">
<img src="monitoring-diagram.png" alt="Prometheus" width="700">
</div>
</div>
<div class="paragraph data-line-189">
<p>However, we will deploy custom <strong>Prometheus</strong> to scrape services metrics of Inventory and Catalog applications. Then we will
visualize the metrics data via custom <strong>Grafana</strong> dashboards deployment.</p>
</div>
<div class="paragraph data-line-192">
<p>On the {{ CONSOLE_URL }}/topology/ns/{{ USER_ID }}-monitoring[Monitoring Topology View, window=_blank], click on <code>+Add</code>, and choose "Container Image"</p>
</div>
<div class="imageblock data-line-194">
<div class="content">
<img src="add-to-project.png" alt="Prometheus" width="800">
</div>
</div>
<div class="paragraph data-line-196">
<p>Fill out the following fields:</p>
</div>
<div class="ulist data-line-198">
<ul>
<li class="data-line-198">
<p><strong>Image Name</strong>: <code>prom/prometheus</code></p>
</li>
<li class="data-line-199">
<p><strong>Name</strong>: <code>prometheus</code></p>
</li>
</ul>
</div>
<div class="paragraph data-line-201">
<p>Click the "Magnifying Glass" search icon next to the image name to confirm the image exists.</p>
</div>
<div class="paragraph data-line-203">
<p>Leave the rest as-is and click <strong>Create</strong>:</p>
</div>
<div class="imageblock data-line-205">
<div class="content">
<img src="search-prometheus-image.png" alt="Prometheus" width="700">
</div>
</div>
<div class="paragraph data-line-207">
<p>On the Topology view, you&#8217;ll see prometheus spinning up. Once it completes, click on the arrow to access the prometheus query UI:</p>
</div>
<div class="imageblock data-line-209">
<div class="content">
<img src="prometheus-route.png" alt="Prometheus" width="700">
</div>
</div>
<div class="paragraph data-line-211">
<p>Which should load the Prometheus Web UI:</p>
</div>
<div class="imageblock data-line-213">
<div class="content">
<img src="prometheus-webui.png" alt="Prometheus" width="700">
</div>
</div>
</div>
<div class="sect3 data-line-215">
<h4 id="_deploy_grafana">Deploy Grafana</h4>
<div class="paragraph data-line-217">
<p>Follow the same process as before: On the {{ CONSOLE_URL }}/topology/ns/{{ USER_ID }}-monitoring[Monitoring Topology View, window=_blank], click on <code>+Add</code>, and choose "Container Image", and fill in the fields:</p>
</div>
<div class="ulist data-line-219">
<ul>
<li class="data-line-219">
<p><strong>Image Name</strong>: <code>grafana/grafana</code></p>
</li>
<li class="data-line-220">
<p><strong>Application</strong>: <code>Unassigned</code></p>
</li>
<li class="data-line-221">
<p><strong>Name</strong>: <code>grafana</code></p>
</li>
</ul>
</div>
<div class="paragraph data-line-223">
<p>Click the "Magnifying Glass" search icon next to the image name to confirm the image exists.</p>
</div>
<div class="paragraph data-line-225">
<p>Leave the rest as-is and click <strong>Create</strong>:</p>
</div>
<div class="imageblock data-line-227">
<div class="content">
<img src="search-grafana-image.png" alt="Grafana" width="700">
</div>
</div>
<div class="paragraph data-line-229">
<p>On the Topology view, you&#8217;ll see Grafana spinning up. Once it completes, click on the arrow to access the Grafana UI:</p>
</div>
<div class="imageblock data-line-231">
<div class="content">
<img src="grafana-route.png" alt="Prometheus" width="700">
</div>
</div>
<div class="paragraph data-line-233">
<p>Which should load the Grafana Web UI:</p>
</div>
<div class="imageblock data-line-235">
<div class="content">
<img src="grafana-login.png" alt="Grafana" width="700">
</div>
</div>
<div class="paragraph data-line-237">
<p>Log into Grafana web UI using the following values:</p>
</div>
<div class="ulist data-line-239">
<ul>
<li class="data-line-239">
<p>Username: admin</p>
</li>
<li class="data-line-240">
<p>Password: admin</p>
</li>
</ul>
</div>
<div class="paragraph data-line-242">
<p><strong>Skip</strong> the Change Password (or change it to something else that you can remember)</p>
</div>
<div class="paragraph data-line-244">
<p>You will see the landing page of Grafana as shown:</p>
</div>
<div class="imageblock data-line-246">
<div class="content">
<img src="grafana-webui.png" alt="Grafana" width="700">
</div>
</div>
</div>
<div class="sect3 data-line-248">
<h4 id="_10_add_a_data_source_to_grafana">10. Add a data source to Grafana</h4>
<div class="paragraph data-line-250">
<p>Click Add data source and select <strong>Prometheus</strong> as data source type.</p>
</div>
<div class="imageblock data-line-252">
<div class="content">
<img src="grafana-datasource-types.png" alt="Grafana" width="700">
</div>
</div>
<div class="paragraph data-line-254">
<p>Fill out the form with the following values:</p>
</div>
<div class="ulist data-line-256">
<ul>
<li class="data-line-256">
<p><strong>URL</strong>: <code><a href="http://prometheus.{{USER_ID}}-monitoring:9090" class="bare">http://prometheus.{{USER_ID}}-monitoring:9090</a></code></p>
</li>
</ul>
</div>
<div class="paragraph data-line-258">
<p>Click on <strong>Save &amp; Test</strong> and confirm you get a success message:</p>
</div>
<div class="imageblock data-line-260">
<div class="content">
<img src="grafana-ds-success.png" alt="Grafana" width="300">
</div>
</div>
<div class="paragraph data-line-262">
<p>At this point Granana is set up to pull collected metrics from Prometheus as they are collected from the application(s) you are monitoring.</p>
</div>
</div>
<div class="sect3 data-line-264">
<h4 id="_11_utilize_metrics_specification_for_inventory_microservice">11. Utilize metrics specification for Inventory Microservice</h4>
<div class="paragraph data-line-266">
<p>In this step, we will learn how <em>Inventory(Quarkus)</em> application can utilize the MicroProfile Metrics specification through the
<strong>SmallRye Metrics extension</strong>. <em>MicroProfile Metrics</em> allows applications to gather various metrics and statistics that provide
insights into what is happening inside the application.</p>
</div>
<div class="paragraph data-line-270">
<p>The metrics can be read remotely using JSON format or the <strong>OpenMetrics</strong> format, so that they can be processed by additional tools
such as <em>Prometheus</em>, and stored for analysis and visualisation.</p>
</div>
<div class="paragraph data-line-273">
<p>Add the necessary Quarkus extensions to the Inventory application for using <em>smallrye-metrics</em> using the following commands in a CodeReady terminal:</p>
</div>
<div class="listingblock copypaste data-line-276">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">mvn quarkus:add-extension -Dextensions="metrics" -f $CHE_PROJECTS_ROOT/cloud-native-workshop-v2m2-labs/inventory</code></pre>
</div>
</div>
<div class="paragraph data-line-280">
<p>You should see in the output:</p>
</div>
<div class="listingblock data-line-283">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">✅ Adding extension io.quarkus:quarkus-smallrye-metrics</code></pre>
</div>
</div>
<div class="paragraph data-line-287">
<p>Let’s add a few annotations to make sure that our desired metrics are calculated over time and can be exported for processing by
<em>Prometheus</em> and <em>Grafana</em>.</p>
</div>
<div class="paragraph data-line-290">
<p>The metrics that we will gather are these:</p>
</div>
<div class="ulist data-line-292">
<ul>
<li class="data-line-292">
<p><code>performedChecksAll</code>: A counter of how many times <code>getAll()</code> has been performed.</p>
</li>
<li class="data-line-293">
<p><code>checksTimerAll</code>: A measure of how long it takes to perform the <code>getAll()</code> method</p>
</li>
<li class="data-line-294">
<p><code>performedChecksAvail</code>: A counter of how many times <code>getAvailability()</code> is called</p>
</li>
<li class="data-line-295">
<p><code>checksTimerAvail</code>: A measure of how long it takes to perform the getAvailability() method</p>
</li>
</ul>
</div>
<div class="paragraph data-line-297">
<p>In the <code>cloud-native-workshop-v2m2-labs/inventory</code> project, open <code>src/main/java/com/redhat/coolstore/InventoryResource.java</code>. Replace the two methods <code>getAll()</code> and
<code>getAvailability()</code> with the below code which adds several annotations for custom metrics (<code>@Counted</code>, <code>@Timed_</code>):</p>
</div>
<div class="listingblock data-line-301">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @GET
    @Counted(name = "performedChecksAll", description = "How many getAll() have been performed.")
    @Timed(name = "checksTimerAll", description = "A measure of how long it takes to perform the getAll().", unit = MetricUnits.MILLISECONDS)
    public List&lt;Inventory&gt; getAll() {
        return Inventory.listAll();
    }

    @GET
    @Counted(name = "performedChecksAvail", description = "How many getAvailability() have been performed.")
    @Timed(name = "checksTimerAvail", description = "A measure of how long it takes to perform the getAvailability().", unit = MetricUnits.MILLISECONDS)
    @Path("{itemId}")
    public List&lt;Inventory&gt; getAvailability(@PathParam String itemId) {
        return Inventory.&lt;Inventory&gt;streamAll()
        .filter(p -&gt; p.itemId.equals(itemId))
        .collect(Collectors.toList());
    }</code></pre>
</div>
</div>
<div class="paragraph data-line-320">
<p>Add the necessary imports at the top:</p>
</div>
<div class="listingblock data-line-323">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import org.eclipse.microprofile.metrics.MetricUnits;
import org.eclipse.microprofile.metrics.annotation.Counted;
import org.eclipse.microprofile.metrics.annotation.Timed;</code></pre>
</div>
</div>
</div>
<div class="sect3 data-line-329">
<h4 id="_12_redeploy_to_openshift">12. Redeploy to OpenShift</h4>
<div class="paragraph data-line-331">
<p>Repackage and redeploy the inventory application:</p>
</div>
<div class="listingblock copypaste data-line-334">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">mvn clean package -DskipTests -f $CHE_PROJECTS_ROOT/cloud-native-workshop-v2m2-labs/inventory &amp;&amp; \
oc start-build -n {{ USER_ID }}-inventory inventory-quarkus --from-file $CHE_PROJECTS_ROOT/cloud-native-workshop-v2m2-labs/inventory/target/*-runner.jar --follow</code></pre>
</div>
</div>
<div class="paragraph data-line-339">
<p>You should get <code>BUILD SUCCESS</code> and then the application should be re-deployed. Watch the {{ CONSOLE_URL }}/topology/ns/{{ USER_ID }}-inventory[Inventory Topology View, window=_blank] until the app is re-deployed.</p>
</div>
<div class="paragraph data-line-341">
<p>Once it&#8217;s done you should be able to see the raw metrics exposed by the app with this command in a Terminal:</p>
</div>
<div class="listingblock copypaste data-line-344">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">curl http://inventory-quarkus-{{USER_ID}}-inventory.{{ ROUTE_SUBDOMAIN }}/metrics</code></pre>
</div>
</div>
<div class="paragraph data-line-348">
<p>You will see a bunch of metrics in the OpenMetrics format:</p>
</div>
<div class="listingblock data-line-351">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console"># HELP vendor_memoryPool_usage_bytes Current usage of the memory pool denoted by the 'name' tag
# TYPE vendor_memoryPool_usage_bytes gauge
vendor_memoryPool_usage_bytes{name="PS Survivor Space"} 916920.0
# HELP vendor_memoryPool_usage_bytes Current usage of the memory pool denoted by the 'name' tag
# TYPE vendor_memoryPool_usage_bytes gauge
vendor_memoryPool_usage_bytes{name="PS Old Gen"} 1.489556E7
# HELP vendor_memory_maxNonHeap_bytes Displays the maximum amount of used non-heap memory in bytes.
# TYPE vendor_memory_maxNonHeap_bytes gauge
vendor_memory_maxNonHeap_bytes 4.52984832E8
# HELP vendor_memory_usedNonHeap_bytes Displays the amount of used non-heap memory in bytes.
# TYPE vendor_memory_usedNonHeap_bytes gauge
vendor_memory_usedNonHeap_bytes 5.4685184E7
... and more</code></pre>
</div>
</div>
<div class="paragraph data-line-367">
<p>This is what Prometheus will use to access and index the metrics from our app when we deploy it to the cluster. But first you must tell Prometheus about it!</p>
</div>
</div>
<div class="sect3 data-line-369">
<h4 id="_configure_prometheus_configmap">Configure Prometheus ConfigMap</h4>
<div class="paragraph data-line-371">
<p>To instruct Prometheus to scrape metrics from our app, we need to create a Kubernetes <em>ConfigMap</em>.</p>
</div>
<div class="paragraph data-line-373">
<p>On the {{ CONSOLE_URL }}/topology/ns/{{ USER_ID }}-monitoring[Monitoring Topology View, window=_blank], click <code>+Add</code> on the left, and this time choose <strong>YAML</strong>:</p>
</div>
<div class="imageblock data-line-375">
<div class="content">
<img src="add-yaml.png" alt="prometheus" width="700">
</div>
</div>
<div class="paragraph data-line-377">
<p>In the empty box, paste in the following YAML code:</p>
</div>
<div class="listingblock copypaste data-line-380">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: prometheus-config
  namespace: {{USER_ID}}-monitoring
data:
  prometheus.yml: &gt;-
    scrape_configs:
      - job_name: 'prometheus'
        static_configs:
        - targets: ['localhost:9090']

      - job_name: 'inventory-quarkus'
        scrape_interval: 10s
        scrape_timeout: 5s
        static_configs:
        - targets: ['inventory-quarkus.{{USER_ID}}-inventory.svc.cluster.local:8080']</code></pre>
</div>
</div>
<div class="paragraph data-line-400">
<p>Config maps hold key-value pairs and in the above command a <strong>prometheus-config</strong> config map is created with <strong>prometheus.yml</strong> as the
key and the above content as the value. Whenever a config map is injected into a container, it would appear as a file with the
same name as the key, at specified path on the filesystem.</p>
</div>
<div class="paragraph data-line-404">
<p>Next, we need to <em>mount</em> this ConfigMap in the filesystem of the Prometheus container so that it can read it. Run this command to
alter the Prometheus deployment to mount it:</p>
</div>
<div class="listingblock copypaste data-line-408">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">oc set volume -n {{USER_ID}}-monitoring deployment/prometheus --add -t configmap --configmap-name=prometheus-config -m /etc/prometheus/prometheus.yml --sub-path=prometheus.yml &amp;&amp; \
oc rollout status -n {{USER_ID}}-monitoring -w deployment/prometheus</code></pre>
</div>
</div>
<div class="paragraph data-line-412">
<p>This will trigger a new deployment of prometheus. Wait for it to finish!</p>
</div>
</div>
<div class="sect3 data-line-414">
<h4 id="_13_generate_some_values_for_the_metrics">13. Generate some values for the metrics</h4>
<div class="paragraph data-line-416">
<p>Now that Prometheus is scraping values from our app, let’s write a loop to call our inventory service multiple times so we can observe the metrics. Do this with the following commands:</p>
</div>
<div class="listingblock copypaste data-line-419">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">URL=http://$(oc get route -n {{ USER_ID }}-inventory inventory-quarkus -o jsonpath={% raw %}"{.spec.host}"{% endraw %})

for i in $(seq 1 500) ; do
  curl -s $URL/services/inventory/165613
  curl -s $URL/services/inventory
  sleep 1
done</code></pre>
</div>
</div>
<div class="paragraph data-line-428">
<p>Leave this loop running (it will end after 300 seconds, or 5 minutes)</p>
</div>
<div class="paragraph data-line-430">
<p>We have 3 ways to view the metrics:</p>
</div>
<div class="olist arabic data-line-432">
<ol class="arabic">
<li class="data-line-432">
<p><code>curl</code> commands (which you already did)</p>
</li>
<li class="data-line-433">
<p>Prometheus Queries</p>
</li>
<li class="data-line-434">
<p>Grafana Dashboards</p>
</li>
</ol>
</div>
</div>
<div class="sect3 data-line-436">
<h4 id="_using_prometheus">Using Prometheus</h4>
<div class="paragraph data-line-438">
<p>Open the <a href="http://prometheus-{{USER_ID}}-monitoring.{{" class="bare">http://prometheus-{{USER_ID}}-monitoring.{{</a> ROUTE_SUBDOMAIN }}[Prometheus UI, target=_blank] and input <code>performedChecks</code> and select the auto-completed value:</p>
</div>
<div class="imageblock data-line-440">
<div class="content">
<img src="prometheus-metrics-console.png" alt="metrics_prometheus" width="900">
</div>
</div>
<div class="paragraph data-line-442">
<p>Switch to <strong>Graph</strong> tab:</p>
</div>
<div class="imageblock data-line-444">
<div class="content">
<img src="prometheus-metrics-graph.png" alt="metrics_prometheus" width="900">
</div>
</div>
<div class="paragraph data-line-446">
<p>You can play with the values for time and see different data across different time ranges for this metric.</p>
</div>
</div>
<div class="sect3 data-line-448">
<h4 id="_using_grafana">Using Grafana</h4>
<div class="paragraph data-line-450">
<p>Open the <a href="http://grafana-{{USER_ID}}-monitoring.{{" class="bare">http://grafana-{{USER_ID}}-monitoring.{{</a> ROUTE_SUBDOMAIN }}[Grafana UI, target=_blank].</p>
</div>
<div class="paragraph data-line-452">
<p>Select <strong>New Dashboard</strong> to create a new <em>Dashboard</em> to review the metrics.</p>
</div>
<div class="imageblock data-line-454">
<div class="content">
<img src="grafana-create-dashboard.png" alt="metrics_grafana" width="900">
</div>
</div>
<div class="paragraph data-line-456">
<p>Select <strong>Add Query</strong> to add a new panel with a query:</p>
</div>
<div class="imageblock data-line-458">
<div class="content">
<img src="grafana-add-query.png" alt="metrics_grafana" width="700">
</div>
</div>
<div class="paragraph data-line-460">
<p>Type in <code>performedChecks</code> in the <em>Metrics</em> field, and choose the first auto-completed value:</p>
</div>
<div class="imageblock data-line-462">
<div class="content">
<img src="grafana-add-query-detail.png" alt="metrics_grafana" width="700">
</div>
</div>
<div class="paragraph data-line-464">
<p>Press kbd:[ENTER] while the cursor is in the field, and the values should begin showing up. Choose <strong>Last 15 Minutes</strong> in the drop-down as shown:</p>
</div>
<div class="imageblock data-line-466">
<div class="content">
<img src="grafana-add-query-detail2.png" alt="metrics_grafana" width="700">
</div>
</div>
<div class="paragraph data-line-468">
<p>You can fine tune the display, along with the type of graph (bar, line, gauge, etc). Using other options. When done, click the "Save" button, give your new dashboard a name, and click <strong>Save</strong>:</p>
</div>
<div class="imageblock data-line-470">
<div class="content">
<img src="grafana-add-query-detail3.png" alt="metrics_grafana" width="700">
</div>
</div>
<div class="paragraph data-line-472">
<p>This is optional, but you can add more Panels if you like, for example: The JVM RSS Value <code>process_resident_memory_bytes</code> (set the visualization type to <code>Gauge</code> and the Field Units to <code>bytes</code> on the <em>Visualization</em> tab, and the title to <code>Memory</code> on the <em>General</em> tab). It could look like:</p>
</div>
<div class="imageblock data-line-474">
<div class="content">
<img src="grafana-add-query-detail4.png" alt="metrics_grafana" width="700">
</div>
</div>
<div class="paragraph data-line-476">
<p>You can see more examples of more complex dashboard, and even import them into your own dashboards from the <a href="https://grafana.com/grafana/dashboards" target="_blank" rel="noopener">Grafana Labs Dashboard community</a>.</p>
</div>
</div>
<div class="sect2 data-line-478">
<h3 id="_summary">Summary</h3>
<div class="paragraph data-line-480">
<p>In this lab, you learned how to monitor cloud-native applications using Jaeger, Prometheus, and Grafana. You also learned how
Quarkus makes your observation tasks easier as a developer and operator. You can use these techniques in future projects to
observe your distributed cloud-native applications.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-02-12 16:42:01 -0500
</div>
</div>
</body>
</html>